(()=>{"use strict";class t{constructor(t){this.uuid=t.uuid,this.repository=t.repository,this.owner=t.owner,this.pull_number=t.pull_number,this.data=t.data,this.events=t.events}getDependencies(){return this.events}}var n=function(t,n,e,o){return new(e||(e=Promise))((function(r,i){function s(t){try{c(o.next(t))}catch(t){i(t)}}function u(t){try{c(o.throw(t))}catch(t){i(t)}}function c(t){var n;t.done?r(t.value):(n=t.value,n instanceof e?n:new e((function(t){t(n)}))).then(s,u)}c((o=o.apply(t,n||[])).next())}))};const e=new class{getAnalysisOutput(n,e,o){return r=this,i=void 0,u=function*(){const r=yield fetch(`http://localhost:4000/analysis?owner=${n}&repo=${e}&pull_number=${o}`).then((t=>t.json())).then((n=>new t(n))).catch((t=>console.error(t)));if(!r)throw new Error("Analysis not found");return r},new((s=void 0)||(s=Promise))((function(t,n){function e(t){try{c(u.next(t))}catch(t){n(t)}}function o(t){try{c(u.throw(t))}catch(t){n(t)}}function c(n){var r;n.done?t(n.value):(r=n.value,r instanceof s?r:new s((function(t){t(r)}))).then(e,o)}c((u=u.apply(r,i||[])).next())}));var r,i,s,u}};chrome.tabs.onUpdated.addListener(((t,o,r)=>n(void 0,void 0,void 0,(function*(){if("complete"!==o.status)return;if(void 0===r.url)throw new Error("tab.url is undefined");const i=r.url.match(/^https:\/\/github\.com\/(.+)\/(.+)\/pull\/(\d+)\/files.*$/);if(null===i)return;console.log("Listener called at: "+r.url);const s=i[1],u=i[2],c=parseInt(i[3]);yield function(t,o,r){return n(this,void 0,void 0,(function*(){return yield e.getAnalysisOutput(t,o,r)}))}(s,u,c).then((n=>{chrome.storage.local.set({analysis:n},(()=>{chrome.scripting.executeScript({target:{tabId:t},files:["./js/content.js"]})}))}))}))))})();